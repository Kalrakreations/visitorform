<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VBook — Visitor Form</title>

  <!-- Theme color (will be updated dynamically by script) -->
  <meta name="theme-color" content="#f5f5f5">

  <!-- ====================
       Inline CSS
       (Comprehensive, readable, contains variables & comments)
       ==================== -->
  <style>
  /* ===================================================
     Visitor Form — CSS (all in one)
     - Theme variables (light default)
     - iOS glass header
     - Floating labels
     - Focus / valid / invalid glows
     - Ripple + button animations
     - Responsive rules
     =================================================== */

  /* ---------- Theme variables (light default) ---------- */
  :root{
    --bg: #f5f7fa;
    --form-bg: #ffffff;
    --text: #222;
    --muted: #8f96a0;
    --primary: #007bff;   /* blue for focus state */
    --success: #28a745;   /* green for success/valid */
    --danger: #ff4d4d;    /* red for invalid */
    --glass-light: rgba(255,255,255,0.6);
    --glass-dark: rgba(30,30,30,0.55);
    --shadow: 0 8px 20px rgba(0,0,0,0.08);
    --header-height: 64px;

    --toggle-width: 52px;
    --toggle-height: 28px;
    --toggle-knob-size: 22px;
  }

  /* ---------- Dark mode overrides ---------- */
  [data-theme="dark"] {
    --bg: #0f1112;
    --form-bg: #131516;
    --text: #f1f1f1;
    --muted: #a6a6a6;
    --primary: #66aaff;
    --shadow: 0 8px 30px rgba(0,0,0,0.6);
    --glass-light: rgba(255,255,255,0.04);
    --glass-dark: rgba(20,20,20,0.6);
  }

  /* ---------- Reset & base ---------- */
  * { box-sizing: border-box; margin:0; padding:0; }
  html,body { height:100%; }
  body {
    font-family: "Inter", "Segoe UI", Roboto, system-ui, -apple-system, "Poppins", sans-serif;
    background: linear-gradient(180deg, var(--bg), #e9eef6 140%);
    color:var(--text);
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding: 18px;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    transition: background .35s ease, color .35s ease;
  }

  /* ---------- Site header (iOS glass) ---------- */
  .site-header {
    position: sticky;
    top: 12px;
    left: 0;
    right: 0;
    max-width: 1100px;
    width: calc(100% - 36px);
    margin: 0 auto 22px auto;
    height: var(--header-height);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding: 12px 18px;
    background: var(--glass-light);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.45);
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    backdrop-filter: blur(10px) saturate(150%);
    -webkit-backdrop-filter: blur(10px) saturate(150%);
    transition: background .35s ease, color .35s ease, box-shadow .35s ease;
    z-index: 40;
  }
  [data-theme="dark"] .site-header {
    background: var(--glass-dark);
    border: 1px solid rgba(255,255,255,0.06);
    box-shadow: 0 10px 30px rgba(0,0,0,0.45);
  }
  .header-left { display:flex; align-items:center; gap:10px; }
  .header-left p { font-weight:600; color:var(--text); margin:0; }
  .header-left a { color:inherit; text-decoration:none; font-weight:700; }

  /* ---------- Theme toggle wrapper ---------- */
  .theme-toggle {
    display:flex;
    align-items:center;
    gap:10px;
    position:relative;
  }
  .theme-toggle .icons {
    display:flex;
    align-items:center;
    gap:8px;
    font-size:18px;
    color: #9aa0a6;
    user-select:none;
  }

  /* Toggle (Apple style) */
  .theme-toggle input[type="checkbox"] { display:none; }
  .switch {
    width:var(--toggle-width);
    height:var(--toggle-height);
    background:#d0d5dd;
    border-radius:999px;
    position:relative;
    display:inline-block;
    vertical-align:middle;
    cursor:pointer;
    transition: background .25s ease;
  }
  .switch::after {
    content:"";
    position:absolute;
    left:3px; top:3px;
    width:var(--toggle-knob-size);
    height:var(--toggle-knob-size);
    background:#fff;
    border-radius:50%;
    box-shadow: 0 3px 10px rgba(0,0,0,0.12);
    transition: transform .35s cubic-bezier(.2,.9,.35,1), background .25s ease;
  }
  .theme-toggle input[type="checkbox"]:checked + .switch {
    background: rgba(255,255,255,0.12);
  }
  .theme-toggle input[type="checkbox"]:checked + .switch::after {
    transform: translateX(calc(var(--toggle-width) - var(--toggle-knob-size) - 6px));
  }

  /* Sun & Moon icons that animate (grey) */
  .theme-icon {
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:18px; height:18px;
    opacity:0.95;
    transition: transform .42s cubic-bezier(.22,.9,.38,1), opacity .32s ease;
    color:#9aa0a6;
    pointer-events:none;
  }

  /* slide icons based on checkbox using sibling selectors in JS by toggling classes (we animate with JS) */

  /* ---------- Form container ---------- */
  .form-wrap {
    width:100%;
    max-width: 1100px;
    background: var(--form-bg);
    border-radius: 14px;
    padding: 26px;
    box-shadow: var(--shadow);
    transition: background .35s ease, box-shadow .35s ease;
    margin-bottom: 60px;
  }
  [data-theme="dark"] .form-wrap { box-shadow: 0 18px 40px rgba(0,0,0,0.5); }

  .form-head {
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:18px;
  }
  .form-head h1 {
    font-size:22px;
    margin:0;
    color:var(--text);
  }
  .form-sub { color:var(--muted); font-size:13px; margin-top:6px; }

  /* ---------- Grid layout for fields ---------- */
  .grid {
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:14px 18px;
  }
  @media (max-width: 820px) {
    .grid { grid-template-columns: 1fr; }
  }

  /* ---------- Input container (floating label) ---------- */
  .input-container {
    position:relative;
    margin:0;
  }

  .input-container input,
  .input-container select,
  .input-container textarea {
    width:100%;
    padding:12px 14px;
    border-radius:10px;
    border:1px solid rgba(0,0,0,0.12);
    background:transparent;
    font-size:15px;
    color:var(--text);
    outline:none;
    transition: border-color .22s ease, box-shadow .22s ease, background .22s ease;
  }

  /* Specific style for selects to avoid the floating label covering */
  .input-container select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    padding-right:36px;
    background-image: linear-gradient(45deg, transparent 50%, var(--muted) 50%),
                      linear-gradient(135deg, var(--muted) 50%, transparent 50%);
    background-position: calc(100% - 20px) calc(1em + 2px), calc(100% - 15px) calc(1em + 2px);
    background-size: 6px 6px, 6px 6px;
    background-repeat: no-repeat;
  }

  .input-container label {
    position:absolute;
    left:14px;
    top:50%;
    transform:translateY(-50%);
    color:var(--muted);
    font-size:15px;
    padding: 0 6px;
    background: transparent;
    pointer-events:none;
    transition: all .22s ease;
  }

  /* Float label when focused or has value (we also apply .filled class from JS) */
  .input-container.filled label,
  .input-container input:focus + label,
  .input-container textarea:focus + label,
  .input-container select:focus + label {
    top:-10px;
    font-size:12px;
    color:var(--primary);
    background: var(--form-bg);
    left:12px;
  }

  /* Make selects that have value look "filled" visually (JS will add .filled) */
  .input-container.filled select {
    border-color:var(--primary);
    box-shadow: 0 6px 18px rgba(0,123,255,0.06);
  }

  /* ---------- Placeholder colors ---------- */
  ::placeholder { color: rgba(0,0,0,0.26); transition: color .2s ease; }
  [data-theme="dark"] ::placeholder { color: rgba(255,255,255,0.18); }

  /* ---------- Focus styles (blue) - only when focused ---------- */
  .input-container input:focus,
  .input-container select:focus,
  .input-container textarea:focus {
    border-color: var(--primary);
    box-shadow: 0 6px 18px rgba(0,123,255,0.08);
  }

  /* ---------- Valid / Invalid states (green/red). Controlled by JS. ---------- */
  .input-container.valid input,
  .input-container.valid select,
  .input-container.valid textarea {
    border-color: var(--success) !important;
    box-shadow: 0 8px 22px rgba(40,167,69,0.12);
  }
  .input-container.invalid input,
  .input-container.invalid select,
  .input-container.invalid textarea {
    border-color: var(--danger) !important;
    box-shadow: 0 8px 22px rgba(255,77,77,0.12);
  }

  /* The phone field will have special classes applied by JS:
     - .phone-focus (blue glow while focused)
     - .phone-invalid (red glow if invalid while India)
     - .phone-valid (green glow when 10 digits for India)
  */
  .input-container.phone-focus input:focus {
    border-color: var(--primary);
    box-shadow: 0 8px 26px rgba(0,123,255,0.12);
  }

  /* ---------- Textarea specifics ---------- */
  textarea {
    min-height:86px;
    resize:vertical;
    font-size:15px;
    padding:12px 14px;
  }

  /* ---------- File input smaller text ---------- */
  input[type="file"] { font-size:13px; padding:8px; }

  /* ---------- Submit button / ripple ---------- */
  .actions { margin-top:18px; display:flex; gap:14px; align-items:center; }
  button.submit-btn {
    position:relative;
    overflow:hidden;
    border: none;
    padding:12px 16px;
    border-radius:10px;
    background: linear-gradient(90deg,var(--primary), #0056d6);
    color:white;
    font-weight:700;
    cursor:pointer;
    min-width:160px;
    display:inline-flex;
    align-items:center;
    gap:10px;
    justify-content:center;
    transition: transform .18s ease, box-shadow .2s ease, background .28s ease;
  }
  button.submit-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
  button.submit-btn:active { transform: translateY(0); }

  /* spinner & ripple helper elements appended by JS */
  .submit-spinner {
    width:18px; height:18px; border-radius:50%;
    border:2px solid rgba(255,255,255,0.85);
    border-top-color: transparent;
    animation: spin 1s linear infinite;
  }
  @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

  /* ripple element style */
  .ripple {
    position:absolute;
    border-radius:50%;
    pointer-events:none;
    transform: translate(-50%,-50%) scale(0.001);
    opacity:0.7;
    animation: rippleExpand 520ms ease-out forwards;
    background: rgba(255,255,255,0.14);
  }
  @keyframes rippleExpand {
    to { transform: translate(-50%,-50%) scale(16); opacity:0; }
  }

  /* Success state (green) after submission */
  .submit-success {
    background: linear-gradient(90deg,var(--success), #1f8b3b) !important;
    box-shadow: 0 12px 28px rgba(40,167,69,0.18) !important;
  }

  /* Disabled style */
  button[disabled] { opacity:0.65; cursor:not-allowed; transform:none; }

  /* ---------- Popup toast ---------- */
  .toast {
    position: fixed;
    right: 18px;
    bottom: 24px;
    background: rgba(0,0,0,0.85);
    color:white;
    padding:12px 16px;
    border-radius:10px;
    font-weight:600;
    display:none;
    z-index:9999;
  }
  .toast.show { display:block; animation: toastIn .28s ease; }
  @keyframes toastIn { from { transform: translateY(8px); opacity:0 } to { transform: translateY(0); opacity:1 } }

  /* ---------- Small helpers ---------- */
  .muted { color:var(--muted); font-size:13px; }
  .full { grid-column: 1 / -1; }

  /* ---------- Responsive adjustments ---------- */
  @media (max-width:560px) {
    body { padding:12px; }
    .site-header { margin: 0 0 18px 0; width: calc(100% - 24px); }
    .form-wrap { padding:18px; }
    .header-left p { font-size:14px; }
  }
  </style>
</head>
<body>

  <!-- ===========================
       Header (iOS glass) 
       =========================== -->
  <header class="site-header" role="banner">
    <div class="header-left">
      <p>
        <a href="https://www.linkedin.com/in/skalra1999/" target="_blank" rel="noopener noreferrer">Sahil Kalra</a>
        &nbsp;|&nbsp;<span class="muted">+91 9646290118</span>
      </p>
    </div>

    <div class="theme-toggle" aria-hidden="false" title="Toggle theme">
      <!-- Sun icon (left) -->
      <span id="iconSun" class="theme-icon" aria-hidden="true" title="Light mode">
        <!-- simple svg sun -->
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#9aa0a6" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"/>
        </svg>
      </span>

      <!-- Toggle checkbox & switch -->
      <input id="themeToggleCheckbox" type="checkbox" aria-label="Toggle dark mode">
      <label for="themeToggleCheckbox" class="switch" role="switch" aria-checked="false"></label>

      <!-- Moon icon (right) -->
      <span id="iconMoon" class="theme-icon" aria-hidden="true" title="Dark mode">
        <!-- simple svg moon -->
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#9aa0a6" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
        </svg>
      </span>
    </div>
  </header>

  <!-- ===========================
       Main Form Container
       =========================== -->
  <main class="form-wrap" role="main">
    <div class="form-head">
      <div>
        <h1>Visitor Form</h1>
        <div class="form-sub muted">Fill visitor details — offline-capable, phone validation, theme aware</div>
      </div>
    </div>

    <form id="visitorForm" autocomplete="off" novalidate>
      <div class="grid">

        <!-- Event Name -->
        <div class="input-container" id="ic-event">
          <input id="eventName" name="eventName" type="text" placeholder=" " />
          <label for="eventName">Event Name</label>
        </div>

        <!-- Name -->
        <div class="input-container" id="ic-name">
          <input id="name" name="name" type="text" placeholder=" " required />
          <label for="name">Name *</label>
        </div>

        <!-- Phone -->
        <div class="input-container" id="ic-phone">
          <input id="phone" name="phone" type="tel" placeholder=" " inputmode="tel" />
          <label for="phone">Phone *</label>
          <div class="muted" style="font-size:12px; margin-top:6px;">If India is selected, phone must be 10 digits.</div>
        </div>

        <!-- Email -->
        <div class="input-container" id="ic-email">
          <input id="email" name="email" type="email" placeholder=" " />
          <label for="email">Email *</label>
        </div>

        <!-- Company -->
        <div class="input-container" id="ic-company">
          <input id="company" name="company" type="text" placeholder=" " />
          <label for="company">Company</label>
        </div>

        <!-- Designation (select + other) -->
        <div class="input-container" id="ic-designation">
          <select id="designation" name="designation" >
            <option value="">Select Designation</option>
            <option>Executive</option>
            <option>Manager</option>
            <option>CEO</option>
            <option>Founder</option>
            <option>Other</option>
          </select>
    
          <input id="designationOther" name="designationOther" type="text" placeholder="Enter designation" style="display:none; margin-top:8px;" />
        </div>

        <!-- Country -->
        <div class="input-container" id="ic-country">
          <select id="country" name="country" >
            <!-- Populated by JS, India selected by default -->
          </select>
          <label for="country">Country</label>
          <input id="countryOther" name="countryOther" type="text" placeholder="Enter Country" style="display:none; margin-top:8px;" />
        </div>

        <!-- State -->
        <div class="input-container" id="ic-state">
          <select id="state" name="state" >
            <option value="">Select State</option>
            <!-- populated by JS -->
          </select>
          <input id="stateOther" name="stateOther" type="text" placeholder="Enter State" style="display:none; margin-top:8px;" />
        </div>

        <!-- City -->
        <div class="input-container" id="ic-city">
          <select id="city" name="city" >
            <option value="">Select City</option>
            <!-- populated by JS -->
          </select>
          
          <input id="cityOther" name="cityOther" type="text" placeholder="Enter City" style="display:none; margin-top:8px;" />
        </div>

        <!-- Business Type -->
        <div class="input-container" id="ic-business">
          <select id="business" name="business" >
            <option value="">Select Business</option>
            <option>Employee</option>
            <option>Trader</option>
            <option>Retailer</option>
            <option>Wholesaler</option>
            <option>Distributor</option>
            <option>Exporter</option>
            <option>E-commerce</option>
            <option>Digital Marketing</option>
            <option>Certification Services</option>
            <option>Hotels</option>
            <option>HoReCa</option>
            <option>Quality</option>
            <option>Marketing</option>
            <option>Other</option>
          </select>
         
          <input id="businessOther" name="businessOther" type="text" placeholder="Enter business type" style="display:none; margin-top:8px;" />
        </div>

        <!-- Department (auto fill, hidden or visible as read-only) -->
        <div class="input-container">
          <input id="department" name="department" type="text" placeholder=" " readonly />
          <label for="department">Assigned Department</label>
        </div>

        <!-- Assigned Person (auto fill, now active + green when filled) -->
        <div class="input-container">
          <input id="assignedPerson" name="assignedPerson" type="text" placeholder=" " readonly />
          <label for="assignedPerson">Assigned Person</label>
        </div>

        <!-- Visiting Card Front -->
        <div class="input-container">
          <input id="vcFront" name="vcFront" type="file" accept="image/*" />
        </div>

        <!-- Visiting Card Back -->
        <div class="input-container">
          <input id="vcBack" name="vcBack" type="file" accept="image/*" />
        </div>

        <!-- Remarks (always floats when filled) -->
        <div class="input-container full" id="ic-remarks">
          <textarea id="remarks" name="remarks" placeholder=" "></textarea>
          <label for="remarks">Remarks / Comments</label>
        </div>

        <!-- Hidden geo inputs (auto-populated by JS) -->
        <input type="hidden" id="latitude" name="latitude" />
        <input type="hidden" id="longitude" name="longitude" />

      </div> <!-- grid -->

      <!-- Actions -->
      <div class="actions">
        <button id="submitBtn" type="submit" class="submit-btn" aria-live="polite">
          <span id="submitText">Submit</span>
        </button>
        <div class="muted" style="align-self:center;">Auto-capture location & offline queue supported</div>
      </div>
    </form>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- ===========================
       Inline JS (comprehensive, commented)
       =========================== -->
  <script>
  /*************************************************************************
   Visitor Form JS (single-file)
   *************************************************************************/

  (function(){
    'use strict';

    const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbzY9kqgmXX6Xr-0mFS3SCMPGf3vGgj2r4iSs1F7JeUdPSXUP92GqwqwLZI_ag7tLi1tYA/exec";

    const doc = document;
    const form = doc.getElementById('visitorForm');
    const businessInput = doc.getElementById('business');
    const departmentInput = doc.getElementById('department');
    const assignedPersonInput = doc.getElementById('assignedPerson');

    function markContainerFilled(el, filled) {
      const container = el.closest('.input-container');
      if (!container) return;
      if (filled) container.classList.add('filled'); else container.classList.remove('filled');
    }

    function applyValidationVisual(el, state) {
      const container = el.closest('.input-container');
      if (!container) return;
      container.classList.remove('valid','invalid');
      if (state === 'valid') container.classList.add('valid');
      else if (state === 'invalid') container.classList.add('invalid');
    }

    function assignDepartmentForBusiness() {
      const val = (businessInput.value || "").toLowerCase();
      let dept = "", person = "";
      if (val.indexOf('exporter') !== -1 || val.indexOf('certification') !== -1) {
        dept = "B2B"; person = "Adhiraj";
      } else if (val.indexOf('digital') !== -1 || val.indexOf('e-commerce') !== -1 || val.indexOf('ecommerce') !== -1) {
        dept = "Ecommerce"; person = "Sahil";
      } else if (['trader','retailer','wholesaler','distributor'].some(k => val.indexOf(k) !== -1)) {
        dept = "General Trade"; person = "Amit";
      } else if (val.indexOf('marketing') !== -1) {
        dept = "Marketing"; person = "Arsh";
      } else if (val.indexOf('quality') !== -1) {
        dept = "Quality"; person = "Neha";
      } else if (val.indexOf('hotel') !== -1 || val.indexOf('horeca') !== -1) {
        dept = "Sales"; person = "Yogesh";
      } else {
        dept = ""; person = "";
      }
      departmentInput.value = dept;
      assignedPersonInput.value = person;
      if (dept) {
        markContainerFilled(departmentInput, true);
        applyValidationVisual(departmentInput, 'valid');
      } else {
        markContainerFilled(departmentInput, false);
        applyValidationVisual(departmentInput, null);
      }
      if (person) {
        markContainerFilled(assignedPersonInput, true);
        applyValidationVisual(assignedPersonInput, 'valid');
      } else {
        markContainerFilled(assignedPersonInput, false);
        applyValidationVisual(assignedPersonInput, null);
      }
    }

    businessInput.addEventListener('change', () => {
      markContainerFilled(businessInput, businessInput.value !== '');
      assignDepartmentForBusiness();
    });

    assignDepartmentForBusiness();
  })();
  </script>
</body>
</html>
